---
title: "August 24, 2025"
excerpt: "Reflecting on the work so far to figure out how to shape the API for Nook Music."
date: "2025-08-24"
author: Geraldine
---

## This is a dev log!

I found myself trying to organize my thoughts about what to do next and figured I’d start a dev log. Usually, I add them to the README for a project, but given the big plans I have for this project, I thought I’d just put it in the project itself. I can reference it, other folks can reference it, it’s a win-win.

I followed the `blog-starter` example by [NextJS](https://github.com/vercel/next.js/tree/canary/examples/blog-starter) with a few tweaks. It mostly had to do with the fact that I couldn’t find a reliable way to ensure external links opened in a new tab. That led me on a rabbit hole down through `remark-external-links` and `remark-hype`. And after some refactors, the dev log is live!

## Nook Music is live!

Nook Music should be live now at https://nook-music.netlify.app. For now, it only plays the hourly background music for your current time and location (location needs to be shared with the browser).

For now, I’ve taken inspiration from [ContentfulClock.com](https://www.contentfulclock.com/). But of course, I’d love to give it a more Animal Crossing feel. I’ve bookmarked [Katherine Manalo’s Animal Crossing UI Kit in Figma](https://www.figma.com/community/file/1155196388062943961/animal-crossing-ui-kit) for when it’s time to cross that bridge.

## Next steps

While working on the blob endpoints, I ran into an issue with [configuring the path to make use of context parameters](https://docs.netlify.com/build/functions/get-started/?data-tab=TypeScript#route-requests). I wanted to be able to write out an endpoint like `/blobs/:type/:key`, where `type` is either `audio` or `image`, and `key` is the file name. I suspect it has to do with the project being a monorepo, and the redirect I setup to go from `/api-v1/*` to `/.netlify/functions/:splat`.

So for the time being, I’ve been using my own parsing helper to get the parameters from the request URL directly. I know it’s not the greatest, but it gets the job down.

Going forward, I’d like to further experiment with adding those pieces to the blob key. So instead of just storing each asset by their file name, I would save the `mjk_Aloha.mp3` audio file as `/audio/songs/mjk_Aloha.mp3`.

For now, to support my Nook Music project, I’ll focus on setting up the following paths:

- GET audio
  - GET hourly audio: `/blobs/audio/hourly/:game/<key>`
    - ACNH: `acnh`
    - ACNL: `acnl`
    - ACCF: `accf`
  - GET KK audio: `/blobs/audio/songs/<key>`
- GET image:
  - GET KK cover art: `/blobs/image/songs/<key>`

And to support this, I believe I’ll need a more sophisticated upload endpoint and form:

- POST blob: `/blobs/<blobPath>`
  - Where `blobPath` is `/:type/:category/:fileName`
    - Where `type` is `audio` or `image`
    - Where category is something like
      - `hourly` or `songs` for `audio`
      - `songs` or `fish` for `image`
    - Example for Aloha K.K. audio: `/audio/songs/mjk_Aloha.mp3`
  - Create Admin Form to upload blobs:
    - Text input for `blobPath`
      - OR radio for `audio` vs `image`
      - AND `category` for `hourly`, `songs`, `fish`
    - File upload

I’d also like to add some security to the upload endpoint. The frontend form is protected based on a role setup with Clerk. But the endpoint itself could still be posted to from anyone. So I’ll probably set something up with JWT.

And now it's back to work!
